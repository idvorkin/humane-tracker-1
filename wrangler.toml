name = "humane-tracker"
compatibility_date = "2024-12-01"
pages_build_output_dir = "humane-tracker/dist"

[build]
command = """
cd humane-tracker && \
npm install && \
SHA=$(git rev-parse HEAD) && \
BRANCH=$(git rev-parse --abbrev-ref HEAD) && \
REPO_URL=$(git remote get-url origin | sed 's/\\.git$//' | sed 's|git@github.com:|https://github.com/|') && \
BUILD_TIME=$(date -u +"%Y-%m-%dT%H:%M:%SZ") && \
cat > src/generated_version.ts << VERSIONEOF
// Auto-generated at build time - DO NOT EDIT
export const GIT_SHA = "$SHA";
export const GIT_COMMIT_URL = "$REPO_URL/commit/$SHA";
export const GIT_CURRENT_URL = "$REPO_URL/tree/$BRANCH";
export const GIT_BRANCH = "$BRANCH";
export const BUILD_TIMESTAMP = "$BUILD_TIME";
VERSIONEOF
npm run build-called-from-just
"""

[vars]
NODE_VERSION = "20"
